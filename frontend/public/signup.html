<!DOCTYPE html>
<html>
<head>
    <title>Sign Up</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link href="https://getbootstrap.com/docs/4.0/examples/signin/signin.css" rel="stylesheet" crossorigin="anonymous"/>
</head>
<body>
<div align="center" class="success-message" id="success-message"></div>
<div align="center" class="error-message" id="error-message" style="display: none;"></div>
<div class="container">
    <form id="signup-form" class="form-signin">
        <h2 class="form-signin-heading">Please sign up</h2>
        <label for="emailId">Email:</label>
        <input type="email" id="emailId" name="emailId" class="form-control" required>

        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" name="firstName" class="form-control" required>

        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" name="lastName" class="form-control" required>

        <label for="password">Password:</label>
        <input type="password" id="password" name="password" class="form-control" required>

        <label for="reenterPassword">Re-enter Password:</label>
        <input type="password" id="reenterPassword" name="reenterPassword" class="form-control" required><br>

        <button class="btn btn-lg btn-primary btn-block" type="submit">Sign up</button>
    </form>
</div>

<script>
  document.getElementById("signup-form").addEventListener("submit", function(event) {
    event.preventDefault();
    document.getElementById("error-message").style.display = "none"; // Hide previous error message

    // Get form data
    var formData = {
      emailId: document.getElementById("emailId").value,
      firstName: document.getElementById("firstName").value,
      lastName: document.getElementById("lastName").value,
      password: document.getElementById("password").value,
      reenterPassword: document.getElementById("reenterPassword").value
    };

    // Perform validation
    if (formData.password !== formData.reenterPassword) {
      displayErrorMessage("Passwords do not match");
      return;
    }

    // Submit form data to /signup URL
    fetch("/signup", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(formData)
    })
    .then(response => {
      if (response.ok) {
        displaySuccessMessage("Sign up successful!. Please check with Admin to activate the user.");

        setTimeout(gotoLogin, 5000);
      } else {
        displayErrorMessage("Sign up failed. Please try again.");
      }
    })
    .catch(error => {
      console.error("Error:", error);
      displayErrorMessage("An error occurred. Please try again later.");
    });
  });

  function gotoLogin() {
    window.location.href = "/login";
  }

  function displayErrorMessage(message) {
    const errorMessage = document.getElementById("error-message");
    errorMessage.style.color = "red";
    errorMessage.innerHTML = message;
    errorMessage.style.display = "block";
  }

  function displaySuccessMessage(message) {
    const errorMessage = document.getElementById("error-message");
    errorMessage.style.color = "green";
    errorMessage.innerHTML = message;
    errorMessage.style.display = "block";
  }
</script>
</body>
</html>
